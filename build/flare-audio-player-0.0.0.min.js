"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++){s(r[o])}return s})({1:[function(require,module,exports){"use strict";var AudioEngine=function(){function AudioEngine(){_classCallCheck(this,AudioEngine);this.context=new(window.AudioContext||window.webkitAudioContext);this.gainNode=this.context.createGain();this.gainNode.connect(this.context.destination);this.audioData=null;this.audioBuffer=null;this.audioSource=null;this.state=0}_createClass(AudioEngine,[{key:"play",value:function play(buffer,offset){this.audioSource=this.context.createBufferSource();this.audioSource.buffer=buffer;this.audioSource.connect(this.gainNode);this.audioSource.onended=this.handlePlayEnd.bind(this);this.audioSource.start(0,offset);this.startTime=this.context.currentTime;return this.startTime}},{key:"getCurrentTime",value:function getCurrentTime(){return this.context.currentTime}},{key:"getStartTime",value:function getStartTime(){return this.startTime}},{key:"togglePlay",value:function togglePlay(){}},{key:"pause",value:function pause(){}},{key:"stop",value:function stop(){this.stopTime=this.context.currentTime;this.audioSource.stop();return this.stopTime}},{key:"handlePlayEnd",value:function handlePlayEnd(e){console.log(e)}},{key:"handleVolumeChanged",value:function handleVolumeChanged(valueData){this.gainNode.gain.value=valueData.percent}}]);return AudioEngine}();var basicPlayer=function(_AudioEngine){_inherits(BasicPlayer,_AudioEngine);function BasicPlayer(url){_classCallCheck(this,BasicPlayer);return _possibleConstructorReturn(this,Object.getPrototypeOf(BasicPlayer).call(this))}_createClass(BasicPlayer,[{key:"registerEndFunction",value:function registerEndFunction(onEndedCallback){this.onEndedCallback=onEndedCallback}}]);return BasicPlayer}(AudioEngine);module.exports=basicPlayer},{}],2:[function(require,module,exports){"use strict";var FlareDomInterface=function(){function FlareDomInterface(){_classCallCheck(this,FlareDomInterface)}_createClass(FlareDomInterface,[{key:"addClass",value:function addClass(){}},{key:"addChild",value:function addChild(element){this.element.appendChild(element.element)}},{key:"removeChild",value:function removeChild(element){this.element.removeChild(element.element)}},{key:"setBaseClassName",value:function setBaseClassName(className){this.baseClassName=className}},{key:"render",value:function render(){this.element.classList.add(this.baseClassName+"-"+this.mainClassName);for(var key in this.styles){this.element.style.setProperty(key,this.styles[key])}for(var key in this.attributes){this.element.setAttribute(key,this.attributes[key])}}},{key:"setStyles",value:function setStyles(styles){this.styles=styles}},{key:"setAttributes",value:function setAttributes(attributes){this.attributes=attributes}},{key:"setContent",value:function setContent(content){this.element.innerHTML=content}},{key:"renderStyles",value:function renderStyles(styles){for(var key in styles){this.styles[key]=styles[key];this.element.style.setProperty(key,styles[key])}}},{key:"renderAttributes",value:function renderAttributes(attributes){for(var key in attributes){this.attributes[key]=attributes[key];this.element.setAttribute(key,attributes[key])}}},{key:"removeChildren",value:function removeChildren(){while(this.element.firstChild){this.element.removeChild(this.element.firstChild)}}}]);return FlareDomInterface}();var FlareDomElement=function(_FlareDomInterface){_inherits(FlareDomElement,_FlareDomInterface);function FlareDomElement(tagName,mainClassName){_classCallCheck(this,FlareDomElement);var _this3=_possibleConstructorReturn(this,Object.getPrototypeOf(FlareDomElement).call(this));_this3.state="0";_this3.tagName=tagName;_this3.mainClassName=mainClassName;_this3.baseClassName="flare";_this3.element=document.createElement(tagName);_this3.classes={};_this3.attributes={};_this3.styles={};return _this3}return FlareDomElement}(FlareDomInterface);var FlareDomElementNs=function(_FlareDomInterface2){_inherits(FlareDomElementNs,_FlareDomInterface2);function FlareDomElementNs(nameSpace,tagName,mainClassName){_classCallCheck(this,FlareDomElementNs);var _this4=_possibleConstructorReturn(this,Object.getPrototypeOf(FlareDomElementNs).call(this));_this4.tagName=tagName;_this4.mainClassName=mainClassName;_this4.baseClassName="flare";_this4.element=document.createElementNS(nameSpace,tagName);_this4.classes={};_this4.attributes={};_this4.styles={};return _this4}return FlareDomElementNs}(FlareDomInterface);var FlareDomSlider=function(_FlareDomElement){_inherits(FlareDomSlider,_FlareDomElement);function FlareDomSlider(tagName,mainClassName){_classCallCheck(this,FlareDomSlider);var _this5=_possibleConstructorReturn(this,Object.getPrototypeOf(FlareDomSlider).call(this,tagName,mainClassName));_this5.valueChangedListeners={};_this5.mouseMoveHandler;_this5.mouseUpHandler;_this5.element.onmousedown=_this5.handleMouseDown.bind(_this5);_this5.mouseMoveHandler=_this5.handleMouseMove.bind(_this5);_this5.mouseUpHandler=_this5.handleMouseUp.bind(_this5);return _this5}_createClass(FlareDomSlider,[{key:"handleMouseDown",value:function handleMouseDown(e){this.clickX=e.x;this.clickY=e.y;this.elementHeight=this.element.offsetHeight;this.boundingRect=this.element.getBoundingClientRect();this.elementHeight=this.boundingRect.bottom-this.boundingRect.top;this.percentValue=1-Math.min(1,Math.max(0,(this.clickY-this.boundingRect.top)/this.elementHeight));this.dispatchValueChangedEvent({percent:this.percentValue});document.addEventListener("mousemove",this.mouseMoveHandler);document.addEventListener("mouseup",this.mouseUpHandler);e.stopPropagation();return false}},{key:"handleMouseUp",value:function handleMouseUp(e){document.removeEventListener("mousemove",this.mouseMoveHandler);document.removeEventListener("mouseup",this.mouseUpHandler);e.stopPropagation;return false}},{key:"addValueChangedListener",value:function addValueChangedListener(listener){this.valueChangedListeners[listener]=listener}},{key:"dispatchValueChangedEvent",value:function dispatchValueChangedEvent(valueData){for(var listener in this.valueChangedListeners){this.valueChangedListeners[listener].call(this,valueData)}}}]);return FlareDomSlider}(FlareDomElement);var FlareVerticalSlider=function(_FlareDomSlider){_inherits(FlareVerticalSlider,_FlareDomSlider);function FlareVerticalSlider(tagName,mainClassName){_classCallCheck(this,FlareVerticalSlider);var _this6=_possibleConstructorReturn(this,Object.getPrototypeOf(FlareVerticalSlider).call(this,"div",mainClassName));_this6.clickY=null;return _this6}_createClass(FlareVerticalSlider,[{key:"handleMouseMove",value:function handleMouseMove(e){var currentY=e.y;this.percentValue=1-Math.min(1,Math.max(0,(currentY-this.boundingRect.top)/this.elementHeight));this.dispatchValueChangedEvent({percent:this.percentValue})}}]);return FlareVerticalSlider}(FlareDomSlider);var FlareHorizontalSlider=function(_FlareDomElement2){_inherits(FlareHorizontalSlider,_FlareDomElement2);function FlareHorizontalSlider(tagName,mainClassName){_classCallCheck(this,FlareHorizontalSlider);var _this7=_possibleConstructorReturn(this,Object.getPrototypeOf(FlareHorizontalSlider).call(this,tagName,mainClassName));_this7.clickX=null;_this7.valueChangedListeners={};_this7.mouseMoveHandler;_this7.mouseUpHandler;_this7.clickX=null;_this7.element.onmousedown=_this7.handleMouseDown.bind(_this7);_this7.mouseMoveHandler=_this7.handleMouseMove.bind(_this7);_this7.mouseUpHandler=_this7.handleMouseUp.bind(_this7);return _this7}_createClass(FlareHorizontalSlider,[{key:"setRange",value:function setRange(minValue,maxValue){this.minValue=minValue;this.maxValue=maxValue;this.range=maxValue-minValue;this.renderAttributes({"aria-valuemin":0,"aria-valuemax":maxValue})}},{key:"handleMouseDown",value:function handleMouseDown(e){this.clickX=e.x;this.clickY=e.y;this.elementWidth=this.element.offsetWidth;this.boundingRect=this.element.getBoundingClientRect();this.percentValue=Math.min(1,Math.max(0,(this.clickX-this.boundingRect.left)/this.elementWidth));this.numericalValue=Math.floor(this.percentValue*this.range);this.quantizedPercent=this.numericalValue/this.range;this.renderAttributes({"aria-valuenow":this.numericalValue});this.dispatchValueChangedEvent({percent:this.percentValue,numerical:this.numericalValue,quantizedPercent:this.quantizedPercent});document.addEventListener("mousemove",this.mouseMoveHandler);document.addEventListener("mouseup",this.mouseUpHandler);console.log("binding");e.stopPropagation();return false}},{key:"handleMouseMove",value:function handleMouseMove(e){var currentX=e.x;this.percentValue=Math.min(1,Math.max(0,(currentX-this.boundingRect.left)/this.elementWidth));this.numericalValue=Math.floor(this.percentValue*this.range);this.quantizedPercent=this.numericalValue/this.range;this.dispatchValueChangedEvent({percent:this.percentValue,numerical:this.numericalValue,quantizedPercent:this.quantizedPercent});this.renderAttributes({"aria-valuenow":this.numericalValue})}},{key:"handleMouseUp",value:function handleMouseUp(e){console.log("mouseup");document.removeEventListener("mousemove",this.mouseMoveHandler);document.removeEventListener("mouseup",this.mouseUpHandler);e.stopPropagation;var currentX=e.x;this.percentValue=Math.min(1,Math.max(0,(currentX-this.boundingRect.left)/this.elementWidth));this.numericalValue=Math.floor(this.percentValue*this.range);this.quantizedPercent=this.numericalValue/this.range;this.dispatchValueChangedEvent({percent:this.percentValue,numerical:this.numericalValue,quantizedPercent:this.quantizedPercent,type:"mouseup"});this.renderAttributes({"aria-valuenow":this.numericalValue});return false}},{key:"addValueChangedListener",value:function addValueChangedListener(listener){this.valueChangedListeners[listener]=listener}},{key:"dispatchValueChangedEvent",value:function dispatchValueChangedEvent(valueData){for(var listener in this.valueChangedListeners){this.valueChangedListeners[listener].call(this,valueData)}}}]);return FlareHorizontalSlider}(FlareDomElement);module.exports.Basic=FlareDomElement;module.exports.BasicNs=FlareDomElementNs;module.exports.HorizontalSlider=FlareHorizontalSlider;module.exports.VerticalSlider=FlareVerticalSlider},{}],3:[function(require,module,exports){"use strict";var FlareDomElements=require("flare-dom-elements");var FlareDomElementNs=FlareDomElements.BasicNs;var FlareIcon=function(_FlareDomElementNs){_inherits(FlareIcon,_FlareDomElementNs);function FlareIcon(){_classCallCheck(this,FlareIcon);var _this8=_possibleConstructorReturn(this,Object.getPrototypeOf(FlareIcon).call(this,"http://www.w3.org/2000/svg","svg","icon"));_this8.renderAttributes({});return _this8}return FlareIcon}(FlareDomElementNs);var FlarePlayIcon=function(_FlareIcon){_inherits(FlarePlayIcon,_FlareIcon);function FlarePlayIcon(){_classCallCheck(this,FlarePlayIcon);var _this9=_possibleConstructorReturn(this,Object.getPrototypeOf(FlarePlayIcon).call(this));_this9.renderAttributes({viewBox:"0 0 256 256"});_this9.playSymbol=new FlareDomElementNs("http://www.w3.org/2000/svg","polygon");_this9.playSymbol.renderAttributes({points:"28.33 20.33 28.33 231.67 231 126 28.33 20.33"});_this9.addChild(_this9.playSymbol);return _this9}return FlarePlayIcon}(FlareIcon);var FlarePauseIcon=function(_FlareIcon2){_inherits(FlarePauseIcon,_FlareIcon2);function FlarePauseIcon(fill){_classCallCheck(this,FlarePauseIcon);var _this10=_possibleConstructorReturn(this,Object.getPrototypeOf(FlarePauseIcon).call(this));_this10.renderAttributes({viewBox:"0 0 256 256"});_this10.pauseLeft=new FlareDomElementNs("http://www.w3.org/2000/svg","path");_this10.pauseLeft.renderAttributes({d:"M95.77,232.75h-21c-9.37,0-17-10.15-17-22.62V45.86c0-12.47,7.63-22.61,17-22.61h21c9.37,0,17,10.14,17,22.61V210.13c0,12.47-7.63,22.62-17,22.62h0Z"});_this10.pauseRight=new FlareDomElementNs("http://www.w3.org/2000/svg","path");_this10.pauseRight.renderAttributes({d:"M181.27,232.75h-21c-9.37,0-17-10.15-17-22.62V45.86c0-12.47,7.63-22.61,17-22.61h21c9.37,0,17,10.14,17,22.61V210.13c0,12.47-7.63,22.62-17,22.62h0Z"});_this10.addChild(_this10.pauseLeft);_this10.addChild(_this10.pauseRight);return _this10}return FlarePauseIcon}(FlareIcon);var FlareVolumeIcon=function(_FlareIcon3){_inherits(FlareVolumeIcon,_FlareIcon3);function FlareVolumeIcon(fill){_classCallCheck(this,FlareVolumeIcon);var _this11=_possibleConstructorReturn(this,Object.getPrototypeOf(FlareVolumeIcon).call(this));_this11.renderAttributes({viewBox:"0 0 256 256"});_this11.vol3=new FlareDomElementNs("http://www.w3.org/2000/svg","path");_this11.vol3.renderAttributes({d:"M171.88,204.38A6.92,6.92,0,0,1,167,192.56a99,99,0,0,0,0-139.8A6.92,6.92,0,0,1,176.77,43a112.84,112.84,0,0,1,0,159.38,6.9,6.9,0,0,1-4.89,2h0Z"});_this11.vol2=new FlareDomElementNs("http://www.w3.org/2000/svg","path");_this11.vol2.renderAttributes({d:"M153.36,185.87a6.92,6.92,0,0,1-4.89-11.82,72.76,72.76,0,0,0,0-102.8,6.92,6.92,0,1,1,9.79-9.79,86.62,86.62,0,0,1,0,122.37,6.9,6.9,0,0,1-4.89,2h0Z"});_this11.vol1=new FlareDomElementNs("http://www.w3.org/2000/svg","path");_this11.vol1.renderAttributes({d:"M133.31,165.83A6.92,6.92,0,0,1,128.42,154a44.31,44.31,0,0,0,0-62.69,6.92,6.92,0,0,1,9.79-9.79,58.15,58.15,0,0,1,0,82.27,6.9,6.9,0,0,1-4.89,2h0Z"});_this11.speaker=new FlareDomElementNs("http://www.w3.org/2000/svg","path");_this11.speaker.renderAttributes({d:"M108,187.1a6.9,6.9,0,0,1-4.33-1.52L72,160.2H52.47a6.92,6.92,0,0,1-6.92-6.92V92.05a6.92,6.92,0,0,1,6.92-6.92H72L103.7,59.74A6.92,6.92,0,0,1,115,65.14v115A6.92,6.92,0,0,1,108,187.1h0ZM59.39,146.36h15a6.92,6.92,0,0,1,4.33,1.52l22.35,17.89V79.54L78.73,97.45A6.89,6.89,0,0,1,74.41,99h-15v47.38h0Z"});_this11.mute1=new FlareDomElementNs("http://www.w3.org/2000/svg","path");_this11.mute1.renderAttributes({d:"M194,164.15a7,7,0,0,1-4.95-2.05l-59.38-59.38a7,7,0,0,1,9.89-9.89L199,152.21A7,7,0,0,1,194,164.15h0Z",opacity:0});_this11.mute2=new FlareDomElementNs("http://www.w3.org/2000/svg","path");_this11.mute2.renderAttributes({d:"M135,164.56a7,7,0,0,1-5-11.88l58.56-60.2a7,7,0,0,1,10,9.76l-58.56,60.2a7,7,0,0,1-5,2.12h0Z",opacity:0});_this11.addChild(_this11.vol3);_this11.addChild(_this11.vol2);_this11.addChild(_this11.vol1);_this11.addChild(_this11.speaker);_this11.addChild(_this11.mute1);_this11.addChild(_this11.mute2);return _this11}_createClass(FlareVolumeIcon,[{key:"setVolume",value:function setVolume(volume){var intensity3;var intensity2;var intensity1;var muteIntensity;if(volume>=.67){intensity3=(volume-.67)/.33;intensity2=1;intensity1=1;muteIntensity=0}else if(volume>=.34){intensity3=0;intensity2=(volume-.34)/.33;intensity1=1;muteIntensity=0}else if(volume>0){intensity3=0;intensity2=0;intensity1=volume/.33;muteIntensity=0}else{intensity3=0;intensity2=0;intensity1=0;muteIntensity=1}this.vol1.renderAttributes({opacity:intensity1});this.vol2.renderAttributes({opacity:intensity2});this.vol3.renderAttributes({opacity:intensity3});this.mute1.renderAttributes({opacity:muteIntensity});this.mute2.renderAttributes({opacity:muteIntensity})}}]);return FlareVolumeIcon}(FlareIcon);var FlareLoadingIcon=function(_FlareIcon4){_inherits(FlareLoadingIcon,_FlareIcon4);function FlareLoadingIcon(){_classCallCheck(this,FlareLoadingIcon);var _this12=_possibleConstructorReturn(this,Object.getPrototypeOf(FlareLoadingIcon).call(this));_this12.degree=0;_this12.renderAttributes({viewBox:"0 0 256 256"});_this12.gear=new FlareDomElementNs("http://www.w3.org/2000/svg","path");_this12.gear.renderAttributes({d:"M138.47,223.76H117.53a13.88,13.88,0,0,1-13.86-13.86V196.35l-6.49-2.52-9.87,9.3a14.21,14.21,0,0,1-19.59,0L52.89,188.3a13.84,13.84,0,0,1,0-19.61l9.55-9.56-2.8-6.42-13.56-.37a13.88,13.88,0,0,1-13.86-13.86v-21A13.88,13.88,0,0,1,46.1,103.66H59.67l2.52-6.49-9.3-9.88a13.84,13.84,0,0,1,0-19.61L67.7,52.88a14.22,14.22,0,0,1,19.61,0l9.57,9.57,6.38-2.81,0.4-13.55a13.88,13.88,0,0,1,13.86-13.86h20.95a13.89,13.89,0,0,1,13.88,13.86V59.66l6.49,2.52,9.85-9.3a13.8,13.8,0,0,1,9.8-4.05h0a13.8,13.8,0,0,1,9.81,4l14.82,14.84a13.87,13.87,0,0,1,0,19.61l-9.57,9.56,2.82,6.39,13.56,0.39a13.87,13.87,0,0,1,13.85,13.86v21a13.87,13.87,0,0,1-13.85,13.86H196.35l-2.53,6.51,9.3,9.86a13.86,13.86,0,0,1,0,19.61l-14.77,14.8a14.21,14.21,0,0,1-19.59,0l-9.61-9.6-6.38,2.81-0.38,13.54a13.89,13.89,0,0,1-13.88,13.86h0ZM120,207.46h16.09V196.35a16.73,16.73,0,0,1,11-15.25l5.6-2.33a14.9,14.9,0,0,1,6.45-1.35A16.39,16.39,0,0,1,170.64,182l7.86,7.86,11.37-11.38L182,170.65a16.72,16.72,0,0,1-3-18.55l2.29-5.6c1.88-5.72,8.44-10.46,15.06-10.46h11.11V120H196.35a16.7,16.7,0,0,1-15.27-11l-2.32-5.56c-2.69-5.37-1.42-13.33,3.23-18l7.88-7.87L178.51,66.13,170.64,74a17,17,0,0,1-18.56,3l-5.59-2.29c-5.71-1.89-10.44-8.45-10.44-15V48.54H120V59.66a16.69,16.69,0,0,1-11,15.25l-5.57,2.33a15,15,0,0,1-6.46,1.36A16.35,16.35,0,0,1,85.36,74l-7.85-7.85L66.14,77.5,74,85.36a16.73,16.73,0,0,1,3,18.55l-2.26,5.58C72.83,115.24,66.27,120,59.67,120H48.54V136H59.67a16.73,16.73,0,0,1,15.26,11l2.32,5.63c2.69,5.36,1.4,13.33-3.25,18l-7.86,7.86,11.37,11.37L85.36,182a16.94,16.94,0,0,1,18.56-3l5.59,2.28c5.84,1.94,10.46,8.36,10.46,15.06v11.11h0Zm8-43.69A35.77,35.77,0,1,1,163.77,128,35.8,35.8,0,0,1,128,163.77h0Zm0-55.23A19.47,19.47,0,1,0,147.47,128,19.48,19.48,0,0,0,128,108.53h0Z"});_this12.addChild(_this12.gear);return _this12}_createClass(FlareLoadingIcon,[{key:"rotate",value:function rotate(degree){this.degree=(this.degree+degree)%360;this.gear.renderAttributes({transform:"rotate("+this.degree+" , 128 , 128 )"})}}]);return FlareLoadingIcon}(FlareIcon);module.exports.FlarePlayIcon=FlarePlayIcon;module.exports.FlarePauseIcon=FlarePauseIcon;module.exports.VolumeIcon=FlareVolumeIcon;module.exports.LoadingIcon=FlareLoadingIcon},{"flare-dom-elements":2}],4:[function(require,module,exports){"use strict";var Flare=Flare||{};Flare.AudioEngine=require("flare-audio-engine");Flare.UI=require("flare-ui-basic-audio-player");Flare.Oscillator=require("flare-oscillator");Flare.BasicAudioPlayer=function(){function _class(options){_classCallCheck(this,_class);this.audioContext=new(window.AudioContext||window.webkitAudioContext);this.options={element:null,resource:null};this.timelinePosition=0;this.startTime=0;this.stopTime=0;this.errorMessage="";this.parseOptions(options);this.volume=1;this.state=0;this.audioEngine=new Flare.AudioEngine("test");this.ui=new Flare.UI(this.options.element);this.ui.setVolume(this.volume);this.oscillator=new Flare.Oscillator;var _this=this;this.ui.registerPlayButtonCallback(function(){_this.handlePlayClick()});this.oscillator.registerUpdateFunction(function(){_this.update()});this.audioEngine.registerEndFunction(function(){_this.handlePlayEnd()});this.ui.addSeekListener(function(valueData){_this.handleSeek(valueData)});this.ui.addVolumeChangedListener(function(valueData){_this.audioEngine.handleVolumeChanged(valueData)});this.bufferData()}_createClass(_class,[{key:"bufferData",value:function bufferData(){this.state=1;this.ui.setState(1);this.oscillator.run();var request=new XMLHttpRequest;request.open("GET",this.options.resource,true);request.responseType="arraybuffer";request.send();request.onload=this.decodeAudio.bind(this)}},{key:"decodeAudio",value:function decodeAudio(e){this.audioData=e.target.response;this.audioContext.decodeAudioData(this.audioData,function(buffer){this.audioBuffer=buffer;this.duration=buffer.duration;this.ui.loadMetaData({duration:buffer.duration});this.state=0;this.ui.setState(0);this.oscillator.stop()}.bind(this),function(e){this.state=-1;this.ui.setState(-1)}.bind(this))}},{key:"parseOptions",value:function parseOptions(options){if(typeof options.element!="undefined"){this.options.element=options.element}if(typeof options.resource!="undefined"){this.options.resource=options.resource}}},{key:"handlePlayClick",value:function handlePlayClick(){switch(this.state){case-1:break;case 0:this.state=2;this.oscillator.run();console.log(this.timelinePosition);this.startTime=this.audioEngine.play(this.audioBuffer,this.timelinePosition);this.ui.setState(2);break;case 1:break;case 2:this.state=0;this.oscillator.stop();this.stopTime=this.audioEngine.stop();this.startTime-this.stopTime;this.timelinePosition+=this.stopTime-this.startTime;console.log(this.timelinePosition);this.ui.setState(0);break;default:}}},{key:"handlePlayEnd",value:function handlePlayEnd(){this.state=0;this.timelinePosition=0;this.oscillator.stop();this.audioEngine.stop();this.ui.setState(0)}},{key:"update",value:function update(){switch(this.state){case 0:break;case 1:this.ui.updateLoadingAnimation();break;case 2:var audioTime=this.audioEngine.getCurrentTime();this.currentPlayTime=this.timelinePosition+(audioTime-this.startTime);var progress=Math.min(Math.max(this.currentPlayTime/this.duration,0),1);if(progress>=1)this.handlePlayEnd();this.ui.updatePlayProgress(progress);this.ui.updateTimeDisplay(this.currentPlayTime);break;default:}}},{key:"processRequestData",value:function processRequestData(e){}},{key:"handleSeek",value:function handleSeek(valueData){console.log(valueData);this.timelinePosition=this.duration*valueData.percent;console.log(this.duration);console.log(valueData.percent)}}],[{key:"loadPlayer",value:function loadPlayer(mediaPlayerElement){var sources=mediaPlayerElement.getElementsByTagName("source");var source=sources[0];var options={element:mediaPlayerElement,resource:source.src};var mediaPlayer=new Flare.BasicAudioPlayer(options)}}]);return _class}();Flare.MediaPlayerFactory=function(){function _class2(){_classCallCheck(this,_class2)}_createClass(_class2,null,[{key:"loadMediaPlayers",value:function loadMediaPlayers(){var mediaPlayerElement;var mediaPlayerElements=document.getElementsByTagName("flaremediaplayer");var playerType;for(var i=0;i<mediaPlayerElements.length;i++){mediaPlayerElement=mediaPlayerElements[i];playerType=mediaPlayerElement.getAttribute("type");if(playerType in Flare.MediaPlayerFactory.mediaPlayers){Flare.MediaPlayerFactory.mediaPlayers[playerType].loadPlayer(mediaPlayerElement)}}}},{key:"registerMediaPlayers",value:function registerMediaPlayers(mediaPlayers){Flare.MediaPlayerFactory.mediaPlayers=mediaPlayers}}]);return _class2}();Flare.MediaPlayerFactory.registerMediaPlayers({"basic-player":Flare.BasicAudioPlayer});Flare.MediaPlayerFactory.loadMediaPlayers()},{"flare-audio-engine":1,"flare-oscillator":5,"flare-ui-basic-audio-player":6}],5:[function(require,module,exports){"use strict";var FlareOscillator=function(){function FlareOscillator(){_classCallCheck(this,FlareOscillator);this.running=false;this._this=this;this.updateFunctions={}}_createClass(FlareOscillator,[{key:"run",value:function run(){var _this=this;this._loopFunction=function(time){return _this.updateRequestAnimationFrame(time)};this.running=true;this._eventId=window.requestAnimationFrame(this._loopFunction)}},{key:"stop",value:function stop(){window.cancelAnimationFrame(this._eventId);this.running=false}},{key:"updateRequestAnimationFrame",value:function updateRequestAnimationFrame(time){this._eventId=window.requestAnimationFrame(this._loopFunction);for(var updateFunction in this.updateFunctions){this.updateFunctions[updateFunction].call()}}},{key:"registerUpdateFunction",value:function registerUpdateFunction(updateFunction){this.updateFunctions[updateFunction]=updateFunction}}]);return FlareOscillator}();module.exports=FlareOscillator},{}],6:[function(require,module,exports){"use strict";var FlareDomElements=require("flare-dom-elements");var FlareIcons=require("flare-icons");var FlareUI=function(){function FlareUI(){_classCallCheck(this,FlareUI);this.baseClass="flare";this.playerElements={}}_createClass(FlareUI,[{key:"setStyle",value:function setStyle(element,styles){for(var style in styles){element.style.setProperty(style,styles[style])}}},{key:"parseTarget",value:function parseTarget(){if(this.target){if(typeof this.target==="string"){this.domLocation=document.getElementById(this.target)}else if(_typeof(this.target)==="object"&&this.target.nodeType===1){this.domLocation=this.target}}else{this.domLocation=document.body}}},{key:"appendToDom",value:function appendToDom(){this.target.appendChild(this.playerElements.container.element)}},{key:"renderElements",value:function renderElements(){for(var key in this.playerElements){this.playerElements[key].render()}}},{key:"updatePlayProgress",value:function updatePlayProgress(percent){var invert=1/percent;if(invert===0)invert=1;this.playerElements.playHandle.renderStyles({transform:"scaleX("+invert+")"});this.playerElements.playProgress.renderStyles({transform:"scaleX("+percent+")"})}},{key:"updateTimeDisplay",value:function updateTimeDisplay(time){var formattedTime=this.formatTime(time);this.playerElements.timeIndicator.setContent(formattedTime+" / "+this.formattedTimelineDuration)}},{key:"handlePlayClick",value:function handlePlayClick(e){this.playButtonCallback.call()}},{key:"setState",value:function setState(state){this.state=state;switch(this.state){case-1:this.playerElements.message.setContent("Error Loading File!");case 0:this.playerElements.playButtonInner.removeChildren();this.playerElements.playButtonInner.addChild(this.playerElements.playIcon);break;case 1:this.playerElements.playButtonInner.removeChildren();this.playerElements.playButtonInner.addChild(this.playerElements.loadingIcon);break;case 2:this.playerElements.playButtonInner.removeChildren();this.playerElements.playButtonInner.addChild(this.playerElements.pauseIcon);break;default:}}},{key:"registerPlayButtonCallback",value:function registerPlayButtonCallback(callback){this.playButtonCallback=callback}},{key:"setTimelineDuration",value:function setTimelineDuration(duration){this.timelineDuration=duration}},{key:"formatTime",value:function formatTime(timeInSeconds){var totalSeconds=Math.floor(timeInSeconds);var min=Math.floor(totalSeconds/60);var seconds=totalSeconds%60;var formattedTime=this.formatDigits(min)+":"+this.formatDigits(seconds);return formattedTime}},{key:"formatDigits",value:function formatDigits(time){if(time>9)return time;else return"0"+time}}]);return FlareUI}();var BasicAudioPlayer=function(_FlareUI){_inherits(BasicAudioPlayer,_FlareUI);function BasicAudioPlayer(target){_classCallCheck(this,BasicAudioPlayer);var _this13=_possibleConstructorReturn(this,Object.getPrototypeOf(BasicAudioPlayer).call(this));_this13.seekListeners={};_this13.colorScheme={primary:"#FF5C00",secondary:"rgba(255,124,0,0.3)",tertiary:"rgba(255,154,0,0.3)",font:"white"};_this13.target=target;_this13.initUI();_this13.renderElements();_this13.appendToDom();_this13.updatePlayProgress(0);console.log("ui loaded");return _this13}_createClass(BasicAudioPlayer,[{key:"loadMetaData",value:function loadMetaData(metaData){this.timelineDuration=metaData.duration;this.formattedTimelineDuration=this.formatTime(this.timelineDuration);this.playerElements.timeIndicator.setContent("0:00 / "+this.formattedTimelineDuration);this.playerElements.progressContainer.setRange(0,Math.floor(metaData.duration))}},{key:"initUI",value:function initUI(){this.playerElements.container=new FlareDomElements.Basic("div","container");this.playerElements.container.setStyles({"background-color":"black",height:"40px",color:"white",display:"block","font-family":"arial"});this.playerElements.controls=new FlareDomElements.Basic("div","controls");this.playerElements.controls.setStyles({display:"table","white-space":"nowrap",height:"100%"});this.playerElements.playButton=new FlareDomElements.Basic("div","play-button");this.playerElements.playButton.setStyles({height:"100%",width:"30px",display:"table-cell","vertical-align":"middle","background-color":this.colorScheme.primary,cursor:"pointer"});this.playerElements.playButtonInner=new FlareDomElements.Basic("div","play-button-inner");this.playerElements.playButtonInner.setStyles({height:"40px",width:"40px"});this.playerElements.playIcon=new FlareIcons.FlarePlayIcon;this.playerElements.pauseIcon=new FlareIcons.FlarePauseIcon;this.playerElements.loadingIcon=new FlareIcons.LoadingIcon;this.playerElements.descriptionContainer=new FlareDomElements.Basic("div","description-container");this.playerElements.descriptionContainer.setStyles({position:"absolute","z-index":1,width:"100%",height:"100%"});this.playerElements.volumeContainer=new FlareDomElements.Basic("div","volume-container");this.playerElements.volumeContainer.setStyles({height:"100%",display:"table-cell","vertical-align":"middle","background-color":this.colorScheme.tertiary,cursor:"pointer"});this.playerElements.volumeContainer.setAttributes({});this.playerElements.volumeSliderOuter=new FlareDomElements.VerticalSlider("div","volume-slider-outer");this.playerElements.volumeSliderOuter.setStyles({height:"100%",width:"40px","background-color":this.colorScheme.tertiary,cursor:"pointer",position:"relative"});this.playerElements.volumeSliderOuter.setAttributes({"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":90,"touch-action":"none",role:"slider"});this.playerElements.volumeSliderInner=new FlareDomElements.Basic("div","volume-slider-inner");this.playerElements.volumeSliderInner.setStyles({height:"100%",width:"100%","background-color":this.colorScheme.primary,"transform-origin":"0px bottom",transform:"scaleY(0)",position:"absolute"});this.playerElements.volumeSliderDisplayContainer=new FlareDomElements.Basic("div","volume-slider-display-container");this.playerElements.volumeSliderDisplayContainer.setStyles({height:"100%",width:"100%",position:"absolute",display:"table"});this.playerElements.volumeSliderDisplay=new FlareDomElements.Basic("div","volume-slider-display");this.playerElements.volumeSliderDisplay.setStyles({position:"absolute",left:"0",right:"0",top:"0",bottom:"0"});this.playerElements.volumeIcon=new FlareIcons.VolumeIcon("white");this.playerElements.timeIndicatorContainer=new FlareDomElements.Basic("div","time-indicator-container");this.playerElements.timeIndicatorContainer.setStyles({height:"100%",display:"table",padding:"0 10px",float:"right"});this.playerElements.timeIndicator=new FlareDomElements.Basic("div","time-indicator");this.playerElements.timeIndicator.setStyles({height:"100%",display:"table-cell","vertical-align":"middle"});this.playerElements.messageContainer=new FlareDomElements.Basic("div","message-container");this.playerElements.messageContainer.setStyles({
height:"100%",display:"table",padding:"0 10px",float:"left"});this.playerElements.message=new FlareDomElements.Basic("div","message");this.playerElements.message.setStyles({height:"100%",display:"table-cell","vertical-align":"middle"});this.playerElements.progressContainer=new FlareDomElements.HorizontalSlider("div","progress-container");this.playerElements.progressContainer.setStyles({height:"1px",width:"100%",display:"table-cell",position:"relative",cursor:"pointer"});this.playerElements.playProgress=new FlareDomElements.Basic("div","play-progress");this.playerElements.playProgress.setStyles({"transform-origin":"0 0 ","background-color":this.colorScheme.secondary,position:"absolute",top:"0",bottom:"0",left:"0",right:"0"});this.playerElements.playHandle=new FlareDomElements.Basic("div","play-handle");this.playerElements.playHandle.setStyles({width:"2px","background-color":"white",height:"100%",float:"right"});this.playerElements.container.addChild(this.playerElements.controls);this.playerElements.controls.addChild(this.playerElements.playButton);this.playerElements.playButton.addChild(this.playerElements.playButtonInner);this.playerElements.playButtonInner.addChild(this.playerElements.playIcon);this.playerElements.controls.addChild(this.playerElements.progressContainer);this.playerElements.progressContainer.addChild(this.playerElements.descriptionContainer);this.playerElements.descriptionContainer.addChild(this.playerElements.timeIndicatorContainer);this.playerElements.descriptionContainer.addChild(this.playerElements.messageContainer);this.playerElements.timeIndicatorContainer.addChild(this.playerElements.timeIndicator);this.playerElements.messageContainer.addChild(this.playerElements.message);this.playerElements.progressContainer.addChild(this.playerElements.playProgress);this.playerElements.playProgress.addChild(this.playerElements.playHandle);this.playerElements.controls.addChild(this.playerElements.volumeContainer);this.playerElements.volumeContainer.addChild(this.playerElements.volumeSliderOuter);this.playerElements.volumeSliderOuter.addChild(this.playerElements.volumeSliderInner);this.playerElements.volumeSliderOuter.addChild(this.playerElements.volumeSliderDisplay);this.playerElements.volumeSliderDisplay.addChild(this.playerElements.volumeIcon);this.playerElements.playButton.element.onclick=this.handlePlayClick.bind(this);var _this=this;this.playerElements.volumeSliderOuter.addValueChangedListener(function(valueData){_this.handleVolumeChanged(valueData)});this.playerElements.progressContainer.addValueChangedListener(function(valueData){_this.handleTimelineSeek(valueData)})}},{key:"setVolume",value:function setVolume(volume){this.handleVolumeChanged({percent:volume})}},{key:"handleVolumeChanged",value:function handleVolumeChanged(valueData){this.playerElements.volumeSliderInner.renderStyles({transform:"scaleY("+valueData.percent+")"});this.playerElements.volumeIcon.setVolume(valueData.percent)}},{key:"addVolumeChangedListener",value:function addVolumeChangedListener(listener){this.playerElements.volumeSliderOuter.addValueChangedListener(listener)}},{key:"handleTimelineSeek",value:function handleTimelineSeek(valueData){this.updateTimeDisplay(valueData.numerical);this.updatePlayProgress(valueData.percent);if(valueData.type==="mouseup"){this.dispatchSeekEvent(valueData)}}},{key:"addSeekListener",value:function addSeekListener(listener){this.seekListeners[listener]=listener}},{key:"dispatchSeekEvent",value:function dispatchSeekEvent(valueData){for(var listener in this.seekListeners){this.seekListeners[listener].call(this,valueData)}}},{key:"updateLoadingAnimation",value:function updateLoadingAnimation(){this.playerElements.loadingIcon.rotate(1)}}]);return BasicAudioPlayer}(FlareUI);module.exports=BasicAudioPlayer},{"flare-dom-elements":2,"flare-icons":3}]},{},[4]);